design <- data.frame(siteID=S$SITEID,
wgt=S$AdjWGT,
xcoord=S$XlongDD,
ycoord=S$YlatDD)
data_tnt <- data.frame(siteID=S$SITEID,
StatusTNT=S$TNT)
TNTextent <- cat.analysis(sites_tnt, subpop, design, data_tnt,
popsize=list(State=framesize))
TNTextent
names(S1data)
sites_target <- data.frame(siteID=S$SITEID, Use=S$TNT == "Target")
data_target <- data.frame(siteID=S$SITEID,
Target_Status=S$EVALSTATUS)
Targetextent <- cat.analysis(sites_target, subpop, design, data_target)
Targetextent
sites_nontarget <- data.frame(siteID=S$SITEID, Use=S$TNT == "NonTarget")
data_nontarget <- data.frame(siteID=S$SITEID,
NonTarget_Status=S$EVALSTATUS)
NonTargetextent <- cat.analysis(sites_nontarget, subpop, design, data_nontarget)
NonTargetextent
names(S1data)
sites_assess <- data.frame(siteID=S$SITEID, Use=S$BugAssess != NA)
sites_assess
AssessRows<- S1data[which(S1data$BugAssess!=NA),]
AssessRows<- S[which(S$BugAssess!=NA),]
dim(AssessRows)
AssessRows
S<-S1data
AssessRows<- S[which(S$BugAssess!=NA),]
AssessRows
S1data
AssessRows<- S[which(S$BugAssess!=NULL),]
AssessRows
AssessData<- S[complete.cases(S$BugAssess),]
AssessData
AssessData<- S[which(S$BugAssess=="Pass"|"Fail"|"Ambiguous"),]
AssessData<- S[which(S$BugAssess=="Pass"|"Fail"),]
AssessData<- S[which(S$BugAssess=="Pass"| S$BugAssess=="Fail"| S$BugAssess=="Ambiguous"),]
AssessData
dim(AssessData)
sites_assess <- data.frame(siteID=AssessData$SITEID, AssessData$BugAssess)
data_assess <- data.frame(siteID=AssessData$SITEID,
CT_DEP_Assessment=AssessData$BugAssess)
AssessmentExtent <- cat.analysis(sites_assess, subpop, design, data_assess)
AssessmentExtent
subpop
AssessData<- S[which(S$BugAssess=="Pass"| S$BugAssess=="Fail"| S$BugAssess=="Ambiguous"),]
sites_assess <- data.frame(siteID=AssessData$SITEID, AssessData$BugAssess)
data_assess <- data.frame(siteID=S$SITEID,
CT_DEP_Assessment=S$BugAssess)
AssessmentExtent <- cat.analysis(sites_assess, subpop, design, data_assess)
sites_assess
AssessData<- S[which(S$BugAssess=="Pass"| S$BugAssess=="Fail"| S$BugAssess=="Ambiguous"),]
sites_assess <- data.frame(siteID=AssessData$SITEID, Assessment=AssessData$BugAssess)
data_assess <- data.frame(siteID=S$SITEID,Assessment=S$BugAssess)
AssessmentExtent <- cat.analysis(sites_assess, subpop, design, data_assess)
AssessmentExtent
sites_assess
data_assess
sites_assess <- data.frame(siteID=S$SITEID, Use=S$BugAssess=="Pass"| S$BugAssess=="Fail"| S$BugAssess=="Ambiguous")
sites_assess
data_assess <- data.frame(siteID=S$SITEID,Assessment=S$BugAssess)
AssessmentExtent <- cat.analysis(sites_assess, subpop, design, data_assess)
AssessmentExtent
S<-S2data ##Identify Survey
framesize <- c("CT_Streams"=12508.5465)  ##Identify Survey Frame Size
sites_tnt <- data.frame(siteID=S$SITEID, Use=rep(TRUE, nrow(S)))
subpop <- data.frame(siteID=S$SITEID,
State=rep("CT_Streams", nrow(S)))
design <- data.frame(siteID=S$SITEID,
wgt=S$AdjWGT,
xcoord=S$XlongDD,
ycoord=S$YlatDD)
data_tnt <- data.frame(siteID=S$SITEID,
StatusTNT=S$TNT)
TNTextent <- cat.analysis(sites_tnt, subpop, design, data_tnt,
popsize=list(State=framesize))
TNTextent
# Estimate why target not sampled
sites_target <- data.frame(siteID=S$SITEID, Use=S$TNT == "Target")
data_target <- data.frame(siteID=S$SITEID,
Target_Status=S$EVALSTATUS)
Targetextent <- cat.analysis(sites_target, subpop, design, data_target)
Targetextent
# Estimate why non-target
sites_nontarget <- data.frame(siteID=S$SITEID, Use=S$TNT == "NonTarget")
data_nontarget <- data.frame(siteID=S$SITEID,
NonTarget_Status=S$EVALSTATUS)
NonTargetextent <- cat.analysis(sites_nontarget, subpop, design, data_nontarget)
NonTargetextent
#
# Estimate assessment decision
#
sites_assess <- data.frame(siteID=S$SITEID, Use=S$BugAssess=="Pass"| S$BugAssess=="Fail"| S$BugAssess=="Ambiguous")
data_assess <- data.frame(siteID=S$SITEID,Assessment=S$BugAssess)
AssessmentExtent <- cat.analysis(sites_assess, subpop, design, data_assess)
AssessmentExtent
S<-S3data ##Identify Survey
framesize <- c("CT_Streams"=12508.5465)  ##Identify Survey Frame Size
sites_tnt <- data.frame(siteID=S$SITEID, Use=rep(TRUE, nrow(S)))
subpop <- data.frame(siteID=S$SITEID,
State=rep("CT_Streams", nrow(S)))
design <- data.frame(siteID=S$SITEID,
wgt=S$AdjWGT,
xcoord=S$XlongDD,
ycoord=S$YlatDD)
data_tnt <- data.frame(siteID=S$SITEID,
StatusTNT=S$TNT)
TNTextent <- cat.analysis(sites_tnt, subpop, design, data_tnt,
popsize=list(State=framesize))
TNTextent
# Estimate why target not sampled
sites_target <- data.frame(siteID=S$SITEID, Use=S$TNT == "Target")
data_target <- data.frame(siteID=S$SITEID,
Target_Status=S$EVALSTATUS)
Targetextent <- cat.analysis(sites_target, subpop, design, data_target)
Targetextent
# Estimate why non-target
sites_nontarget <- data.frame(siteID=S$SITEID, Use=S$TNT == "NonTarget")
data_nontarget <- data.frame(siteID=S$SITEID,
NonTarget_Status=S$EVALSTATUS)
NonTargetextent <- cat.analysis(sites_nontarget, subpop, design, data_nontarget)
NonTargetextent
#
# Estimate assessment decision
#
sites_assess <- data.frame(siteID=S$SITEID, Use=S$BugAssess=="Pass"| S$BugAssess=="Fail"| S$BugAssess=="Ambiguous")
data_assess <- data.frame(siteID=S$SITEID,Assessment=S$BugAssess)
AssessmentExtent <- cat.analysis(sites_assess, subpop, design, data_assess)
AssessmentExtent
S<-S1data ##Identify Survey
framesize <- c("CT_Streams"=12508.5465)  ##Identify Survey Frame Size
sites_tnt <- data.frame(siteID=S$SITEID, Use=rep(TRUE, nrow(S)))
subpop <- data.frame(siteID=S$SITEID,
State=rep("CT_Streams", nrow(S)))
design <- data.frame(siteID=S$SITEID,
wgt=S$AdjWGT,
xcoord=S$XlongDD,
ycoord=S$YlatDD)
data_tnt <- data.frame(siteID=S$SITEID,
StatusTNT=S$TNT)
TNTextent <- cat.analysis(sites_tnt, subpop, design, data_tnt,
popsize=list(State=framesize))
TNTextent
# Estimate why target not sampled
sites_target <- data.frame(siteID=S$SITEID, Use=S$TNT == "Target")
data_target <- data.frame(siteID=S$SITEID,
Target_Status=S$EVALSTATUS)
Targetextent <- cat.analysis(sites_target, subpop, design, data_target)
Targetextent
# Estimate why non-target
sites_nontarget <- data.frame(siteID=S$SITEID, Use=S$TNT == "NonTarget")
data_nontarget <- data.frame(siteID=S$SITEID,
NonTarget_Status=S$EVALSTATUS)
NonTargetextent <- cat.analysis(sites_nontarget, subpop, design, data_nontarget)
NonTargetextent
#
# Estimate assessment decision
#
sites_assess <- data.frame(siteID=S$SITEID, Use=S$BugAssess=="Pass"| S$BugAssess=="Fail"| S$BugAssess=="Ambiguous")
data_assess <- data.frame(siteID=S$SITEID,Assessment=S$BugAssess)
AssessmentExtent <- cat.analysis(sites_assess, subpop, design, data_assess)
AssessmentExtent
S<-S2data ##Identify Survey
framesize <- c("CT_Streams"=12508.5465)  ##Identify Survey Frame Size
sites_tnt <- data.frame(siteID=S$SITEID, Use=rep(TRUE, nrow(S)))
subpop <- data.frame(siteID=S$SITEID,
State=rep("CT_Streams", nrow(S)))
design <- data.frame(siteID=S$SITEID,
wgt=S$AdjWGT,
xcoord=S$XlongDD,
ycoord=S$YlatDD)
data_tnt <- data.frame(siteID=S$SITEID,
StatusTNT=S$TNT)
TNTextent <- cat.analysis(sites_tnt, subpop, design, data_tnt,
popsize=list(State=framesize))
TNTextent
# Estimate why target not sampled
sites_target <- data.frame(siteID=S$SITEID, Use=S$TNT == "Target")
data_target <- data.frame(siteID=S$SITEID,
Target_Status=S$EVALSTATUS)
Targetextent <- cat.analysis(sites_target, subpop, design, data_target)
Targetextent
# Estimate why non-target
sites_nontarget <- data.frame(siteID=S$SITEID, Use=S$TNT == "NonTarget")
data_nontarget <- data.frame(siteID=S$SITEID,
NonTarget_Status=S$EVALSTATUS)
NonTargetextent <- cat.analysis(sites_nontarget, subpop, design, data_nontarget)
NonTargetextent
#
# Estimate assessment decision
#
sites_assess <- data.frame(siteID=S$SITEID, Use=S$BugAssess=="Pass"| S$BugAssess=="Fail"| S$BugAssess=="Ambiguous")
data_assess <- data.frame(siteID=S$SITEID,Assessment=S$BugAssess)
AssessmentExtent <- cat.analysis(sites_assess, subpop, design, data_assess)
AssessmentExtent
setwd("/Users/tbecker/Documents/Projects/GitHubProjects/ProbMonPrj")##Set working directory
library(spsurvey)
library(ggplot2)
library(grid)
library(gridExtra)
library(plyr)
library(reshape2)
data <- read.table("data/ProbMonDesign_2001_2015_041118.csv",sep=",",header=TRUE)
data$BugBCG<-as.character(data$BugBCG)
data$BugBCG[data$BugBCG=="6"]<-"5"###Replace 6 with 5 All Impaired Few 6s
data$BugBCG<-factor(data$BugBCG,levels=c("2","3","4","5"))
dim(data)
data[1:10,]
addmargins(table(data$EVALSTATUS, data$BugAssess))
S1data<-data[which(data$SurveyName=="2001-2005"),]
S2data<-data[which(data$SurveyName=="2006-2010"),]
S3data<-data[which(data$SurveyName=="2011-2015"),]
framesize <- c("CT_Streams1"=9931.3570)##Total Design Stream Length KM
S1data$AdjWGT <- adjwgt(rep(TRUE, nrow(S1data)),
S1data$WGT,
rep("CT_Streams1", nrow(S1data)),
framesize)
sum(S1data$AdjWGT)
#Survey 2
framesize <- c("CT_Streams2"=12508.5465)
S2data$AdjWGT <- adjwgt(rep(TRUE, nrow(S2data)),
S2data$WGT,
rep("CT_Streams2", nrow(S2data)),
framesize)
sum(S2data$AdjWGT)
#Survey 3
framesize <- c("CT_Streams2"=12508.5465)
S3data$AdjWGT <- adjwgt(rep(TRUE, nrow(S3data)),
S3data$WGT,
rep("CT_Streams2", nrow(S3data)),
framesize)
sum(S3data$AdjWGT)
Sdata<- rbind(S1data,S2data,S3data)##Combine Surveys Back Together
sites<- data.frame(siteID=Sdata$SITEID,Use=Sdata$EVALSTATUS=="CMPLTE")
subpop<- data.frame(siteID=Sdata$SITEID,Survey=Sdata$SurveyName)
design <- data.frame(siteID=Sdata$SITEID,
wgt=Sdata$AdjWGT,
xcoord=Sdata$XlongDD,
ycoord=Sdata$YlatDD)
framesize<- c("2001-2005"=9931.3570,"2006-2010"=12508.5465,"2011-2015"=12508.5465)
sites.bcg<- data.frame(siteID=Sdata$SITEID, Use=Sdata$BugBCG=="2"| Sdata$BugBCG=="3"|
Sdata$BugBCG=="4"|Sdata$BugBCG=="5")
data.assess <- data.frame(siteID=Sdata$SITEID,Assessment=Sdata$BugBCG)
AssessmentExtent <- cat.analysis(sites.bcg, subpop, design, data.assess,popsize=list
(Survey=as.list(framesize)))
sites.bcg
sites.bugs<- data.frame(siteID=Sdata$SITEID, Use=Sdata$BugAssess=="Pass"| Sdata$BugAssess=="Fail"|
Sdata$BugAssess=="Ambiguous")
sites.bugs[1:10,]
sites.bcg$Use<-ifelse(sites.bcg$Use==NA,FALSE,TRUE)
sites.bcg[1:10,]
sites.bcg$Use<-ifelse(sites.bcg$Use=='NA',FALSE,TRUE)
sites.bcg[1:10,]
data <- read.table("data/ProbMonDesign_2001_2015_041118.csv",sep=",",header=TRUE)
data[1:10,]
data$BugBCG<-as.character(factor(data$BugBCG))
data[1:10,]
data$BugBCG=="NA"<-NA
data[BugBCG=="NA"]
data[BugBCG=="NA",]
data$BugBCG=="NA"
data <- read.table("data/ProbMonDesign_2001_2015_041118.csv",sep=",",header=TRUE)
data[1:10,]
data$BugBCG[data$BugBCG=="BCG6"]<-"BCG5"###Replace 6 with 5 All Impaired Few 6s
dim(data)
data[1:10,]
sites.bcg<- data.frame(siteID=Sdata$SITEID, Use=Sdata$BugBCG=="2"| Sdata$BugBCG=="3"|
Sdata$BugBCG=="4"|Sdata$BugBCG=="5")
sites.bcg[1:10,]
S1data<-data[which(data$SurveyName=="2001-2005"),]
S2data<-data[which(data$SurveyName=="2006-2010"),]
S3data<-data[which(data$SurveyName=="2011-2015"),]
#######Adjust sample weights to account for use of oversample sites and differing GIS stream length#######
#Survey 1
framesize <- c("CT_Streams1"=9931.3570)##Total Design Stream Length KM
S1data$AdjWGT <- adjwgt(rep(TRUE, nrow(S1data)),
S1data$WGT,
rep("CT_Streams1", nrow(S1data)),
framesize)
sum(S1data$AdjWGT)
#Survey 2
framesize <- c("CT_Streams2"=12508.5465)
S2data$AdjWGT <- adjwgt(rep(TRUE, nrow(S2data)),
S2data$WGT,
rep("CT_Streams2", nrow(S2data)),
framesize)
sum(S2data$AdjWGT)
#Survey 3
framesize <- c("CT_Streams2"=12508.5465)
S3data$AdjWGT <- adjwgt(rep(TRUE, nrow(S3data)),
S3data$WGT,
rep("CT_Streams2", nrow(S3data)),
framesize)
sum(S3data$AdjWGT)
Sdata<- rbind(S1data,S2data,S3data)##Combine Surveys Back Together
############Set up data frames needed for analysis#############
sites<- data.frame(siteID=Sdata$SITEID,Use=Sdata$EVALSTATUS=="CMPLTE")
subpop<- data.frame(siteID=Sdata$SITEID,Survey=Sdata$SurveyName)
design <- data.frame(siteID=Sdata$SITEID,
wgt=Sdata$AdjWGT,
xcoord=Sdata$XlongDD,
ycoord=Sdata$YlatDD)
framesize<- c("2001-2005"=9931.3570,"2006-2010"=12508.5465,"2011-2015"=12508.5465)
sites.bcg<- data.frame(siteID=Sdata$SITEID, Use=Sdata$BugBCG=="BCG2"| Sdata$BugBCG=="BCG3"|
Sdata$BugBCG=="BCG4"|Sdata$BugBCG=="BCG5")
sites.bcg[1:10,]
data.assess <- data.frame(siteID=Sdata$SITEID,Assessment=Sdata$BugBCG)
AssessmentExtent <- cat.analysis(sites.bcg, subpop, design, data.assess,popsize=list
(Survey=as.list(framesize)))
Assessment<-AssessmentExtent[c(1:2,4:6,8:10),]
Assessment
Assessment
sites.bcg[1:50,]
subpop[1:10,]
design[1:10,]
data.assess[1:10,]
data.assess[1:50,]
data.assess[50:100,]
popsize
list
(Survey=as.list(framesize)))
Survey
framesize
AssessmentExtent
Assessment<-AssessmentExtent[c(1:4,6:9),]
AssessmentPlot<- ggplot(Assessment,aes(x=Subpopulation,y=Estimate.P,fill=Category))+
geom_bar(position=position_dodge(),stat="identity",colour="black",size=0.3,
width=0.7)+
geom_errorbar(aes(ymin=LCB95Pct.P,ymax=UCB95Pct.P),width=0.2,
position=position_dodge(0.7))+
scale_fill_manual(values=c("grey","darkseagreen","deepskyblue4","blue"))+
labs(x= "Survey",y="Estimated Proportion of Stream Length")+
theme_bw()+
theme(legend.position=c(0.12,0.85),legend.title=element_blank(),
legend.background=element_rect(fill=alpha("transparent",0)))
AssessmentPlot
sites.bugs<- data.frame(siteID=Sdata$SITEID, Use=Sdata$BugAssess=="Pass"| Sdata$BugAssess=="Fail"|
Sdata$BugAssess=="Ambiguous")
data.assess <- data.frame(siteID=Sdata$SITEID,Assessment=Sdata$BugAssess)
AssessmentExtent <- cat.analysis(sites.bugs, subpop, design, data.assess,popsize=list
(Survey=as.list(framesize)))
AssessmentExtent
Assessment<-AssessmentExtent[c(1:2,4:6,8:10),]
AddAmbig<- data.frame(Type="Survey",Subpopulation="2001-2005",Indicator="Assessment",
Category="Ambiguous",NResp=0,
Estimate.P=0,StdError.P=0,LCB95Pct.P=0,UCB95Pct.P=0,Estimate.U=0,
StdError.U=0,LCB95Pct.U=0,UCB95Pct.U=0)#Pad Ambig data to give plot equal bar width
Assessment<- rbind(Assessment,AddAmbig)
AssessmentPlot<- ggplot(Assessment,aes(x=Subpopulation,y=Estimate.P,fill=Category))+
geom_bar(position=position_dodge(),stat="identity",colour="black",size=0.3,
width=0.7)+
geom_errorbar(aes(ymin=LCB95Pct.P,ymax=UCB95Pct.P),width=0.2,
position=position_dodge(0.7))+
scale_fill_manual(values=c("grey","darkseagreen","deepskyblue4"))+
labs(x= "Survey",y="Estimated Proportion of Stream Length")+
theme_bw()+
theme(legend.position=c(0.12,0.85),legend.title=element_blank(),
legend.background=element_rect(fill=alpha("transparent",0)))
AssessmentPlot
sites.bcg<- data.frame(siteID=Sdata$SITEID, Use=Sdata$BugBCG=="BCG2"| Sdata$BugBCG=="BCG3"|
Sdata$BugBCG=="BCG4"|Sdata$BugBCG=="BCG5")
data.assess <- data.frame(siteID=Sdata$SITEID,Assessment=Sdata$BugBCG)
AssessmentExtent <- cat.analysis(sites.bcg, subpop, design, data.assess,popsize=list
(Survey=as.list(framesize)))
AssessmentExtent
Assessment<-AssessmentExtent[c(1:4,6:9),]
AssessmentPlot<- ggplot(Assessment,aes(x=Subpopulation,y=Estimate.P,fill=Category))+
geom_bar(position=position_dodge(),stat="identity",colour="black",size=0.3,
width=0.7)+
geom_errorbar(aes(ymin=LCB95Pct.P,ymax=UCB95Pct.P),width=0.2,
position=position_dodge(0.7))+
scale_fill_manual(values=c("grey","darkseagreen","deepskyblue4","blue"))+
labs(x= "Survey",y="Estimated Proportion of Stream Length")+
theme_bw()+
theme(legend.position=c(0.12,0.85),legend.title=element_blank(),
legend.background=element_rect(fill=alpha("transparent",0)))
AssessmentPlot
ggsave(results/BCGPlot.JPG)
ggsave(BCGPlot.JPG)
AssessmentPlot<- ggplot(Assessment,aes(x=Subpopulation,y=Estimate.P,fill=Category))+
geom_bar(position=position_dodge(),stat="identity",colour="black",size=0.3,
width=0.7)+
geom_errorbar(aes(ymin=LCB95Pct.P,ymax=UCB95Pct.P),width=0.2,
position=position_dodge(0.7))+
scale_fill_manual(values=c("grey","darkseagreen","deepskyblue4","blue"))+
labs(x= "Survey",y="Estimated Proportion of Stream Length")+
theme_bw()+
theme(legend.position=c(0.12,0.85),legend.title=element_blank(),
legend.background=element_rect(fill=alpha("transparent",0)))
AssessmentPlot
ggsave("results/BCGPlot.JPG")
sites.bugs<- data.frame(siteID=Sdata$SITEID, Use=Sdata$BugAssess=="Pass"| Sdata$BugAssess=="Fail"|
Sdata$BugAssess=="Ambiguous")
data.assess <- data.frame(siteID=Sdata$SITEID,Assessment=Sdata$BugAssess)
AssessmentExtent <- cat.analysis(sites.bugs, subpop, design, data.assess,popsize=list
(Survey=as.list(framesize)))
AssessmentExtent
Assessment<-AssessmentExtent[c(1:2,4:6,8:10),]
AddAmbig<- data.frame(Type="Survey",Subpopulation="2001-2005",Indicator="Assessment",
Category="Ambiguous",NResp=0,
Estimate.P=0,StdError.P=0,LCB95Pct.P=0,UCB95Pct.P=0,Estimate.U=0,
StdError.U=0,LCB95Pct.U=0,UCB95Pct.U=0)#Pad Ambig data to give plot equal bar width
Assessment<- rbind(Assessment,AddAmbig)
AssessmentPlotMMI<- ggplot(Assessment,aes(x=Subpopulation,y=Estimate.P,fill=Category))+
geom_bar(position=position_dodge(),stat="identity",colour="black",size=0.3,
width=0.7)+
geom_errorbar(aes(ymin=LCB95Pct.P,ymax=UCB95Pct.P),width=0.2,
position=position_dodge(0.7))+
scale_fill_manual(values=c("grey","darkseagreen","deepskyblue4"))+
labs(x= "Survey",y="Estimated Proportion of Stream Length")+
theme_bw()+
theme(legend.position=c(0.12,0.85),legend.title=element_blank(),
legend.background=element_rect(fill=alpha("transparent",0)))
ggsave("results/PassFailAssessment.JPG")
setwd("/Users/tbecker/Documents/Projects/GitHubProjects/ProbMonPrj")##Set working directory
library(spsurvey)
library(ggplot2)
library(grid)
library(gridExtra)
library(plyr)
library(reshape2)
# Read data
data <- read.table("data/ProbMonDesign_2001_2015_080118.csv",sep=",",header=TRUE)
data$BugBCG[data$BugBCG=="BCG6"]<-"BCG5"###Replace 6 with 5 All Impaired Few 6s
data$FishBCG[data$FishBCG=="BCG6"]<-"BCG5"
dim(data)
data[1:10,]
S1data<-data[which(data$SurveyName=="2001-2005"),]
S2data<-data[which(data$SurveyName=="2006-2010"),]
S3data<-data[which(data$SurveyName=="2011-2015"),]
framesize <- c("CT_Streams1"=9931.3570)##Total Design Stream Length KM
S1data$AdjWGT <- adjwgt(rep(TRUE, nrow(S1data)),
S1data$WGT,
rep("CT_Streams1", nrow(S1data)),
framesize)
sum(S1data$AdjWGT)
#Survey 2
framesize <- c("CT_Streams2"=12508.5465)
S2data$AdjWGT <- adjwgt(rep(TRUE, nrow(S2data)),
S2data$WGT,
rep("CT_Streams2", nrow(S2data)),
framesize)
sum(S2data$AdjWGT)
#Survey 3
framesize <- c("CT_Streams2"=12508.5465)
S3data$AdjWGT <- adjwgt(rep(TRUE, nrow(S3data)),
S3data$WGT,
rep("CT_Streams2", nrow(S3data)),
framesize)
sum(S3data$AdjWGT)
Sdata<- rbind(S1data,S2data,S3data)##Combine Surveys Back Together
sites<- data.frame(siteID=Sdata$SITEID,Use=Sdata$EVALSTATUS=="CMPLTE")
subpop<- data.frame(siteID=Sdata$SITEID,Survey=Sdata$SurveyName)
design <- data.frame(siteID=Sdata$SITEID,
wgt=Sdata$AdjWGT,
xcoord=Sdata$XlongDD,
ycoord=Sdata$YlatDD)
framesize<- c("2001-2005"=9931.3570,"2006-2010"=12508.5465,"2011-2015"=12508.5465)
sites.fishbcg<- data.frame(siteID=Sdata$SITEID, Use=Sdata$FishBCG=="BCG2"| Sdata$FishBCG=="BCG3"|
Sdata$FishBCG=="BCG4"|Sdata$FishBCG=="BCG5")
data.assess <- data.frame(siteID=Sdata$SITEID,Assessment=Sdata$FishBCG)
AssessmentExtent <- cat.analysis(sites.fishbcg, subpop, design, data.assess,popsize=list
(Survey=as.list(framesize)))
AssessmentExtent
Assessment<-AssessmentExtent[c(1:4,6:9),]
Assessment
Assessment<-AssessmentExtent[c(1:4,6:9,11:14),]
AssessmentPlot<- ggplot(Assessment,aes(x=Subpopulation,y=Estimate.P,fill=Category))+
geom_bar(position=position_dodge(),stat="identity",colour="black",size=0.3,
width=0.7)+
geom_errorbar(aes(ymin=LCB95Pct.P,ymax=UCB95Pct.P),width=0.2,
position=position_dodge(0.7))+
scale_fill_manual(values=c("grey","darkseagreen","deepskyblue4","blue"))+
labs(x= "Survey",y="Estimated Proportion of Stream Length")+
theme_bw()+
theme(legend.position=c(0.12,0.85),legend.title=element_blank(),
legend.background=element_rect(fill=alpha("transparent",0)))
AssessmentPlot
sites.fishbcg<- data.frame(siteID=Sdata$SITEID, Use=Sdata$FishBCG=="BCG1" |
Sdata$FishBCG=="BCG2"| Sdata$FishBCG=="BCG3"|
Sdata$FishBCG=="BCG4"|Sdata$FishBCG=="BCG5")
data.assess <- data.frame(siteID=Sdata$SITEID,Assessment=Sdata$FishBCG)
AssessmentExtent <- cat.analysis(sites.fishbcg, subpop, design, data.assess,popsize=list
(Survey=as.list(framesize)))
AssessmentExtent
Assessment<-AssessmentExtent[c(1:4,6:9,11:14),]
Assessment<-AssessmentExtent[c(1:5,7:11,13:17),]
Assessment
AssessmentPlot<- ggplot(Assessment,aes(x=Subpopulation,y=Estimate.P,fill=Category))+
geom_bar(position=position_dodge(),stat="identity",colour="black",size=0.3,
width=0.7)+
geom_errorbar(aes(ymin=LCB95Pct.P,ymax=UCB95Pct.P),width=0.2,
position=position_dodge(0.7))+
scale_fill_manual(values=c("grey","darkseagreen","deepskyblue4","blue"))+
labs(x= "Survey",y="Estimated Proportion of Stream Length")+
theme_bw()+
theme(legend.position=c(0.12,0.85),legend.title=element_blank(),
legend.background=element_rect(fill=alpha("transparent",0)))
AssessmentPlot
AssessmentPlot<- ggplot(Assessment,aes(x=Subpopulation,y=Estimate.P,fill=Category))+
geom_bar(position=position_dodge(),stat="identity",colour="black",size=0.3,
width=0.7)+
geom_errorbar(aes(ymin=LCB95Pct.P,ymax=UCB95Pct.P),width=0.2,
position=position_dodge(0.7))+
scale_fill_manual(values=c("grey","darkseagreen","deepskyblue4","blue","green"))+
labs(x= "Survey",y="Estimated Proportion of Stream Length")+
theme_bw()+
theme(legend.position=c(0.12,0.85),legend.title=element_blank(),
legend.background=element_rect(fill=alpha("transparent",0)))
AssessmentPlot
ggsave("results/BCGFishPlot.JPG")
